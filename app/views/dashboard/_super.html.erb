
<!-- Right side column. Contains the navbar and content of the page -->
<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        Dashboard
        <!-- <small>Control panel</small> -->
    </h1>
    <ol class="breadcrumb">
        <li><a href="/"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Dashboard</li>
    </ol>
</section>

<!-- Main content -->
<section class="content">
  <!-- Small boxes (Stat box) -->
  <div class="row">
    <div class="col-md-4">
      <!-- small box -->
      <div class="small-box bg-green">
        <div class="inner">
          <h3>
            <%= Device.all.count %>
          </h3>
          <p>
            Current Devices
          </p>
        </div>
        <div class="icon">
          <i class="fa fa-laptop"></i>
        </div>
        <a href="/devices" class="small-box-footer">
          More info <i class="fa fa-arrow-circle-right"></i>
        </a>
      </div>
      <% if !@r_device1.nil? %>
        <div class="box box-danger" id="loading-example">
        <div class="box-header">
          <!-- tools box -->
          <div class="pull-right box-tools">
            <button class="btn btn-success btn-sm refresh-btn" data-toggle="tooltip" title="Reload"><i class="fa fa-refresh"></i></button>
            <button class="btn btn-success btn-sm" data-widget='collapse' data-toggle="tooltip" title="Collapse"><i class="fa fa-minus"></i></button>
            <button class="btn btn-success btn-sm" data-widget='remove' data-toggle="tooltip" title="Remove"><i class="fa fa-times"></i></button>
          </div><!-- /. tools -->
          <i class="fa fa-cloud" style="color:green"></i>
          <h3 class="box-title">Recent Device</h3>
        </div><!-- /.box-header -->
        <div class="box-body no-padding">
          <div class="row">
            <div class="col-sm-4">
              <span class="pull-left" style="font-size:16px;">&nbsp;&nbsp;Device Name: </span>
              <span class="pull-right" style="font-size:16px;color:green;"><%= Device.last.name %></small></span>
              <br/><br/>
              <!-- bar chart -->
              <div class="chart" id="bar-chart" style="text-align:center;">
                <%= image_tag('server1.png', size: "120") %>
              </div>
            </div>
            <div class="col-sm-8">
              <div class="pad">
                <!-- Progress bars -->
                <div class="clearfix">
                    <span class="pull-left">Cores </span>
                    <small class="pull-right"><%= @r_device1.osprocessor %></small>
                </div>
                <div class="progress xs">
                    <div class="progress-bar progress-bar-green" style="width: <%= get_processor(@r_device1.osprocessor) %>%"></div>
                </div>

                <div class="clearfix">
                    <span class="pull-left">RAM Capacity</span>
                    <small class="pull-right"><%= @r_device1.osram %></small>
                </div>
                <div class="progress xs">
                    <div class="progress-bar progress-bar-red" style="width: <%= get_ram(@r_device1.osram) %>%;"></div>
                </div>
                <div class="clearfix">
                  <span class="pull-left">Created: </span>
                  <small class="pull-right"><%= @r_device1.created_at %></small>
                </div>
                <div class="clearfix">
                  <span class="pull-left">Updated: </span>
                  <small class="pull-right"><%= @r_device1.updated_at %></small>
                </div>
                <br/>
                <p>
                  <!-- <button class="btn btn-success btn-sm"><i class="fa fa-cloud-download"></i> Upgrade</button> -->
                  <%#= link_to 'Upgrade', edit_device_path(@r_device1), :class=>'btn btn-success btn-sm' %>
                  <%= link_to edit_device_path(@r_device1), :class=>'btn btn-success btn-sm' do %>
                    <i class="fa fa-cloud-download"></i> Upgrade
                  <% end %>
                </p>
              </div><!-- /.pad -->
            </div><!-- /.col -->
          </div><!-- /.row - inside box -->
        </div><!-- /.box-body -->
      </div>
      <% end %>

      <% if !@r_device2.nil? %>
        <div class="box box-danger" id="loading-example">
          <div class="box-header">
            <!-- tools box -->
            <div class="pull-right box-tools">
              <button class="btn btn-success btn-sm refresh-btn" data-toggle="tooltip" title="Reload"><i class="fa fa-refresh"></i></button>
              <button class="btn btn-success btn-sm" data-widget='collapse' data-toggle="tooltip" title="Collapse"><i class="fa fa-minus"></i></button>
              <button class="btn btn-success btn-sm" data-widget='remove' data-toggle="tooltip" title="Remove"><i class="fa fa-times"></i></button>
            </div><!-- /. tools -->
            <i class="fa fa-cloud" style="color:green"></i>
            <h3 class="box-title">Recent Device</h3>
          </div><!-- /.box-header -->
          <div class="box-body no-padding">
            <div class="row">
              <div class="col-sm-4">
                <span class="pull-left" style="font-size:16px;">&nbsp;&nbsp;Device Name: </span>
                <span class="pull-right" style="font-size:16px;color:green;"><%= @r_device2.name %></small></span>
                <br/><br/>
                <!-- bar chart -->
                <div class="chart" id="bar-chart" style="text-align:center;">
                  <%= image_tag('server1.png', size: "120") %>
                </div>
              </div>
              <div class="col-sm-8">
                <div class="pad">
                  <!-- Progress bars -->
                  <div class="clearfix">
                      <span class="pull-left">Cores </span>
                      <small class="pull-right"><%= @r_device2.osprocessor %></small>
                  </div>
                  <div class="progress xs">
                      <div class="progress-bar progress-bar-green" style="width: <%= get_processor(@r_device2.osprocessor) %>%;"></div>
                  </div>

                  <div class="clearfix">
                      <span class="pull-left">RAM Capacity</span>
                      <small class="pull-right"><%= @r_device2.osram %></small>
                  </div>
                  <div class="progress xs">
                      <div class="progress-bar progress-bar-red" style="width: <%= get_ram(@r_device2.osram) %>%;"></div>
                  </div>
                  <div class="clearfix">
                    <span class="pull-left">Created: </span>
                    <small class="pull-right"><%= @r_device2.created_at %></small>
                  </div>
                  <div class="clearfix">
                    <span class="pull-left">Updated: </span>
                    <small class="pull-right"><%= @r_device2.updated_at %></small>
                  </div>
                  <br/>
                  <p>
                    <%= link_to edit_device_path(@r_device2), :class=>'btn btn-success btn-sm' do %>
                      <i class="fa fa-cloud-download"></i> Upgrade
                    <% end %>
                  </p>
                </div><!-- /.pad -->
              </div><!-- /.col -->
            </div><!-- /.row - inside box -->
          </div><!-- /.box-body -->
        </div>
      <% end %>
    </div><!-- ./col -->

    <div class="col-md-4">
      <!-- small box -->
      <div class="small-box bg-aqua">
        <div class="inner">
          <h3>
            <%= Ticket.all.count %>
          </h3>
          <p>
            Existing Tickets
          </p>
        </div>
        <div class="icon">
          <i class="fa fa-fw fa-ticket"></i>
        </div>
        <a href="/tickets" class="small-box-footer">
          More info <i class="fa fa-arrow-circle-right"></i>
        </a>
      </div>

      <% if !@r_ticket1.nil? %>
        <div class="box box-info">
          <div class="box-header">
            <i class="fa fa-fw fa-tag" style="color: #00acd6"></i>
            <h3 class="box-title">Recent Ticket</h3>
            <!-- tools box -->
            <div class="pull-right box-tools">
              <button class="btn btn-info btn-sm" data-widget="remove" data-toggle="tooltip" title="Remove"><i class="fa fa-times"></i></button>
            </div><!-- /. tools -->
          </div>
          <div class="box-body" style="padding-left:32px;">
            <div class="row">
              <span>ID: </span>
              <span style="color:#00c0ef">#&nbsp;<%= @r_ticket1.id %>  </span>
            </div>
            <div class="row">
              <span>Owner: </span>
              <span style="color:#00c0ef"><%= @r_ticket1.owner %></span>
            </div>
            <div class="row">
              <span>Title: </span>
              <span style="color:#00c0ef">
                <% if !@r_ticket1.group.nil? %>
                  <%= @r_ticket1.group %>
                <% end %>
              </span>
            </div>
            <div class="row">
              <span>Created: </span>
              <span style="color:#00c0ef"><%= @r_ticket1.created_at %></span>
            </div>
          </div>
          <div class="box-footer clearfix">
            <!-- <button class="pull-right btn btn-info" id="sendEmail">Check now <i class="fa fa-arrow-circle-right"></i></button> -->
            <%= link_to edit_ticket_path(@r_ticket1), :class=>'pull-right btn btn-info' do %>
              Check now <i class="fa fa-fw fa-check"></i>
            <% end %>
          </div>
        </div>
      <% end %>

      <% if !@r_ticket2.nil? %>
        <div class="box box-info">
          <div class="box-header">
            <i class="fa fa-fw fa-tag" style="color: #00acd6"></i>
            <h3 class="box-title">Recent Ticket</h3>
            <!-- tools box -->
            <div class="pull-right box-tools">
              <button class="btn btn-info btn-sm" data-widget="remove" data-toggle="tooltip" title="Remove"><i class="fa fa-times"></i></button>
            </div><!-- /. tools -->
          </div>
          <div class="box-body" style="padding-left:32px;">
            <div class="row">
              <span>ID: </span>
              <span style="color:#00c0ef">#&nbsp;<%= @r_ticket2.id %>  </span>
            </div>
            <div class="row">
              <span>Owner: </span>
              <span style="color:#00c0ef"><%= @r_ticket2.owner %></span>
            </div>
            <div class="row">
              <span>Title: </span>
              <span style="color:#00c0ef">
                <% if !@r_ticket2.group.nil? %>
                  <%= @r_ticket2.group %>
                <% end %>
              </span>
            </div>
            <div class="row">
              <span>Created: </span>
              <span style="color:#00c0ef"><%= @r_ticket2.created_at %></span>
            </div>
          </div>
          <div class="box-footer clearfix">
            <!-- <button class="pull-right btn btn-info" id="sendEmail">Check now <i class="fa fa-fw fa-check-circle"></i></button> -->
            <%= link_to edit_ticket_path(@r_ticket2), :class=>'pull-right btn btn-info' do %>
              Check now <i class="fa fa-fw fa-check"></i>
            <% end %>
          </div>
        </div>
      <% end %>

      <!-- quick email widget -->
      <div class="box box-info">
        <div class="box-header">
          <i class="fa fa-envelope" style="color: #00acd6"></i>
          <h3 class="box-title">Quick Email</h3>
          <!-- tools box -->
          <div class="pull-right box-tools">
            <button class="btn btn-info btn-sm" data-widget="remove" data-toggle="tooltip" title="Remove"><i class="fa fa-times"></i></button>
          </div><!-- /. tools -->
        </div>
        <div class="box-body">
          <form action="#" method="post">
            <div class="form-group">
              <input type="email" class="form-control" name="emailto" placeholder="Email to:"/>
            </div>
            <div class="form-group">
              <input type="text" class="form-control" name="subject" placeholder="Subject"/>
            </div>
            <div>
              <textarea class="textarea" placeholder="Message" style="width: 100%; height: 125px; font-size: 14px; line-height: 18px; border: 1px solid #dddddd; padding: 10px;"></textarea>
            </div>
          </form>
        </div>
        <div class="box-footer clearfix">
          <button class="pull-right btn btn-info" id="sendEmail">Send <i class="fa fa-arrow-circle-right"></i></button>
        </div>
      </div>
    </div><!-- ./col -->

    <div class="col-md-4">
      <!-- small box -->
      <div class="small-box bg-yellow">
        <div class="inner">
          <h3>
            <%= Account.all.count %>
          </h3>
          <p>
            User Registrations
          </p>
        </div>
        <div class="icon">
          <i class="ion ion-person-add"></i>
        </div>
        <a href="/accounts" class="small-box-footer">
          More info <i class="fa fa-arrow-circle-right"></i>
        </a>
      </div>

      <div class="box box-warning">
        <div class="box-header">
          <!-- tools box -->
          <div class="pull-right box-tools">                                        
            <button class="btn btn-warning btn-sm daterange pull-right" data-toggle="tooltip" title="Date range"><i class="fa fa-calendar"></i></button>
            <button class="btn btn-warning btn-sm pull-right" data-widget='collapse' data-toggle="tooltip" title="Collapse" style="margin-right: 5px;"><i class="fa fa-minus"></i></button>
          </div><!-- /. tools -->

          <i class="fa fa-map-marker" style="color:#f39c12"></i>
          <h3 class="box-title">
            Visiting History
          </h3>
        </div>
        <div class="box-body no-padding">
          <div class="table-responsive">
            <table class="listing" id="visiting_list">
              <thead>
                <tr>
                  <th colspan="0">User</th>
                  <th>Last Date</th>
                  <th>Last IP</th>
                  <th>Sign In count</th>
                </tr>
              </thead>

              <tbody>
                <% sc = 0 %>
                <% if !@accounts.blank? %>
                  <% @accounts.each do |a| %>
                    <% if sc < 5 %>
                      <tr>
                        <td><%= processblank(a.email.split('@').first) %></td>
                        <td><%= processblank(a.last_sign_in_at) %></td>
                        <td><%= processblank(a.last_sign_in_ip) %></td>
                        <td><%= processblank(a.sign_in_count) %></td>
                        <% sc = sc + 1 %>
                      </tr>
                    <% end %>
                  <% end %>
                <% end %>
              </tbody>
            </table>
          </div>
        </div><!-- /.box-body-->
      </div>
    </div><!-- ./col -->
  </div><!-- /.row -->
</section>